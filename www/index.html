<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * data: gap: https://ssl.gstatic.com; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <script src="components/loader.js"></script>
    <link rel="stylesheet" href="components/loader.css">

    <script src="components/onsenui/js/onsenui.min.js"></script>
    <link rel="stylesheet" href="components/onsenui/css/onsenui.min.css">
    <link rel="stylesheet" href="components/onsenui/css/onsen-css-components.min.css">

    <script src="lib/jquery-3.2.1.slim.min.js" async></script>
    <script src="lib/twitter.relative.time.min.js" async></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/css/emojione.min.css" />
    <script src="https://twemoji.maxcdn.com/twemoji.min.js"></script>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/enquete.css">
    <link rel="stylesheet" href="css/dark.css">
    <link rel="stylesheet" href="css/custom-size.css">

    <script>
        var now_TL = "local";
        var last_load_TL = "";
        var tmp_post_text = "";
        var toot_new_id = "";
        var toot_old_id = "";
        var account_toot_old_id = "";
        var account_page_id = "";
        var alert_new_id = "";
        var alert_old_id = "";
        var more_status_id = "";
        var more_acct_id = "";
        var tmp_bbcode_id = "";
        var tmp_bbcode_limit = "";
        var tmp_bbcode_tootbutton = "";
        var emoji_list = Array();
        var emoji_num_a = Array();
        var emoji_num = 0;
        var account_page_acct = "";
        var tmp_text_pre = "";
        var tmp_post_reply = 0;
        var tmp_post_visibility = "";
        var follow_old_id = "";
        var tmp_media_del_id = 0;
        var tmp_media_del_obj = "";
        var tag_old_id = "";
        var tag_str = "";
        var list_old_id = "";
        var old_TL_ws = "";
        var image_mode = "";
        var now_page = "";
        var old_page = "";
    </script>

    <script src="js/server/server.js"></script>
    <script src="js/init.js"></script>
    <script src="js/components.js"></script>
    <script src="js/login.js"></script>
    <script src="js/toot_new.js"></script>
    <script src="js/toot.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/account.js"></script>
    <script src="js/list.js"></script>
    <script src="js/music.js"></script>
    <script src="js/search.js"></script>
    <script src="js/account_change.js"></script>

    <audio id="music-control"></audio>
</head>
<body>
<ons-splitter>
    <ons-splitter-side id="splitter-menu" side="left" width="280px" collapse>
        <ons-page>
            <ons-list>
                <ons-list-item class="splitter-profile-item" id="splitter-profile-bg">
                    <div class="splitter-profile">
                        <img src="img/missing.png" id="splitter-icon" class="user-logo" onclick="show_account(localStorage.getItem('knzk_userid'), true)"/>
                        <p>
                        <h4 id="splitter-profile-name" class="toot-small"></h4>
                        </p>
                    </div>
                </ons-list-item>
                <ons-list-item onclick="account_change_panel()" tappable>
                    <div class="center list-item-small">
                        @<span id="account_change-username"></span>
                    </div>
                    <div class="right list-item-small">
                        <ons-icon icon="fa-caret-down"></ons-icon>
                    </div>
                </ons-list-item>
            </ons-list>

            <div id="account-list" style="display: none;"></div>
            <div id="menu-list-base">
                <div id="menu-list">
                    <ons-list>
                        <ons-search-input placeholder="検索" onkeydown="SearchKey();" input-id="nav-search" class="w-max" style="background-color: #3D4454;"></ons-search-input>
                        <ons-list-header>ナビゲーション</ons-list-header>
                        <ons-list-item modifier="chevron" tappable onclick="openTL()">
                            <div class="left">
                                <i class="list-item__icon list-item--chevron__icon ons-icon fa-home fa fa-fw"></i>
                            </div>
                            <div class="center">
                                タイムライン
                            </div>
                        </ons-list-item>
                        <ons-list-item modifier="chevron" tappable onclick="openTL('alert')">
                            <div class="left">
                                <i class="list-item__icon list-item--chevron__icon ons-icon fa-bell fa fa-fw"></i>
                            </div>
                            <div class="center">
                                通知
                            </div>
                        </ons-list-item>
                        <ons-list-item modifier="chevron" tappable onclick="list('favourites', 'お気に入り一覧', null, 'toot')">
                            <div class="left">
                                <i class="list-item__icon list-item--chevron__icon ons-icon fa-star fa fa-fw"></i>
                            </div>
                            <div class="center">
                                お気に入り一覧
                            </div>
                        </ons-list-item>
                        <ons-list-item modifier="chevron" tappable onclick="load('usermenu.html')">
                            <div class="left">
                                <i class="list-item__icon list-item--chevron__icon ons-icon fa-ellipsis-h fa fa-fw"></i>
                            </div>
                            <div class="center">
                                その他
                            </div>
                        </ons-list-item>
                        <ons-list-item modifier="chevron" tappable onclick="load('config.html')">
                            <div class="left">
                                <i class="list-item__icon list-item--chevron__icon ons-icon fa-cog fa fa-fw"></i>
                            </div>
                            <div class="center">
                                設定
                            </div>
                        </ons-list-item>
                    </ons-list>
                </div>

                <form id="music-form" style="display: none;">
                    <ons-list>
                        <ons-list-header>Channel</ons-list-header>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" input-id="listen-moe" value="listen-moe" checked></ons-radio></label>
                            <label for="listen-moe" class="center music-item">Listen.moe</label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" input-id="ncs" value="ncs"></ons-radio></label>
                            <label for="ncs" class="center music-item">NCS</label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" value="Poolside-fm" input-id="Poolside-fm"></ons-radio></label>
                            <label for="Poolside-fm" class="center music-item">Poolside.fm</label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" value="dubplate-fm" input-id="dubplate-fm"></ons-radio></label>
                            <label for="dubplate-fm" class="center music-item">Drum 'n Bass   <small>(dubplate.fm)</small></label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" value="FUTURE-BASS-MIX" input-id="FUTURE-BASS-MIX"></ons-radio></label>
                            <label for="FUTURE-BASS-MIX" class="center music-item">FUTURE-BASS-MIX</label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" value="TOP-40-RU" input-id="TOP-40-RU"></ons-radio></label>
                            <label for="TOP-40-RU" class="center music-item">TOP 40 RU   <small>(European Hit Radio)</small></label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" value="REMIXES-RU" input-id="REMIXES-RU"></ons-radio></label>
                            <label for="REMIXES-RU" class="center music-item">REMIXES RU   <small>(European Hit Radio)</small></label>
                        </ons-list-item>
                        <ons-list-item tappable onclick="music_set('music-button',true)">
                            <label class="left music-item"><ons-radio name="channel" value="danceradiouk" input-id="danceradiouk"></ons-radio></label>
                            <label for="danceradiouk" class="center music-item">danceradiouk   <small>(Box UK Radio)</small></label>
                        </ons-list-item>
                    </ons-list>
                </form>

                <ons-list class="splitter-bottom">
                    <ons-list-item onclick="music_change()" tappable>
                        <div class="center list-item-small" id="music-title">
                            Listen.moe
                        </div>
                        <div class="right list-item-small">
                            <ons-icon icon="fa-caret-up"></ons-icon>
                        </div>
                    </ons-list-item>
                    <ons-list-item onclick="music_set('music-button')" tappable>
                        <div class="center">
                            <i class="list-item__icon ons-icon fa-play fa fa-fw fa-2x" id="music-button"></i>
                        </div>
                        <div class="right">
                            Music 🎶
                        </div>
                    </ons-list-item>
                </ons-list>
            </div>
        </ons-page>
    </ons-splitter-side>
    <ons-splitter-content id="splitter-content" page="init.html"></ons-splitter-content>
</ons-splitter>

<ons-template id="usermenu.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="fn.open()">
                    <ons-icon icon="fa-bars"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">ユーザーメニュー</div>
        </ons-toolbar>
        <ons-list>
            <ons-list-item modifier="chevron" tappable onclick="list('pin', '固定トゥート一覧', null, 'toot', true)">
                <div class="left">
                    <i class="list-item__icon list-item--chevron__icon ons-icon fa-thumb-tack fa fa-fw"></i>
                </div>
                <div class="center">
                    固定したトゥート
                </div>
            </ons-list-item>
            <ons-list-item modifier="chevron" tappable onclick="list('follow_requests', 'フォローリクエスト', null, 'acct', true)">
                <div class="left">
                    <i class="list-item__icon list-item--chevron__icon ons-icon fa-users fa fa-fw"></i>
                </div>
                <div class="center">
                    フォローリクエスト
                </div>
            </ons-list-item>
            <ons-list-item modifier="chevron" tappable onclick="list('mutes', 'ミュート一覧', null, 'acct', true)">
                <div class="left">
                    <i class="list-item__icon list-item--chevron__icon ons-icon fa-volume-off fa fa-fw"></i>
                </div>
                <div class="center">
                    ミュートしたユーザー
                </div>
            </ons-list-item>
            <ons-list-item modifier="chevron" tappable onclick="list('blocks', 'ブロック一覧', null, 'acct', true)">
                <div class="left">
                    <i class="list-item__icon list-item--chevron__icon ons-icon fa-ban fa fa-fw"></i>
                </div>
                <div class="center">
                    ブロックしたユーザー
                </div>
            </ons-list-item>
        </ons-list>
    </ons-page>
</ons-template>

<template id="init.html">
    <ons-page>
        <ons-navigator id="navigator" page="home.html"></ons-navigator>
    </ons-page>
</template>

<ons-template id="home.html">
    <ons-page id="home">
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="TL_prev()">
                    <ons-icon icon="fa-angle-left"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div id="home_title" class="center">ローカル</div>
            <div class="right">
                <ons-toolbar-button onclick="TL_next()">
                    <ons-icon icon="fa-angle-right"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>
        <ons-carousel fullscreen auto-scroll id="carousel" auto-scroll-ratio="0.5">
            <ons-carousel-item>
                <div id="local_main">
                    <div class="loading-now">
                        <ons-progress-circular indeterminate></ons-progress-circular>
                    </div>
                </div>
            </ons-carousel-item>
            <ons-carousel-item>
                <div id="home_main">
                    <div class="loading-now">
                        <ons-progress-circular indeterminate></ons-progress-circular>
                    </div>
                </div>
            </ons-carousel-item>
            <ons-carousel-item>
                <div id="public_main">
                    <div class="loading-now">
                        <ons-progress-circular indeterminate></ons-progress-circular>
                    </div>
                </div>
            </ons-carousel-item>
        </ons-carousel>
        <ons-speed-dial position="bottom right" direction="up" onclick="opendial()" id="dial_main" class="invisible">
            <ons-fab>
                <ons-icon icon="fa-bell" id="dial-icon"></ons-icon>
            </ons-fab>
        </ons-speed-dial>
        <ons-bottom-toolbar id="simple_toot_TL_toolbar">
            <form id="simple_toot_form">
                <input type="hidden" id="nsfw_input_simple">
                <input type="hidden" id="post_mode_simple" value="public">
                <input type="hidden" id="post_reply_simple">
                <ons-list>
                    <ons-list-item style="padding-left: 0" class="simple-toot">
                        <div class="left" style="padding-right: 6px">
                            <ons-button modifier="large--quiet" onclick="fn.open()"><ons-icon icon="fa-bars"></ons-icon></ons-button>
                        </div>
                        <div class="center">
                            <textarea class="textarea w-max" rows="1" placeholder="トゥート！" id="simple_toot_TL_input" onFocus="simple_open()" onkeyup="check_limit(value, 'toot_limit_simple', 'toot-button_simple', 'simple_toot_cw');"></textarea>
                        </div>
                        <div class="right" style="padding-right: 0">
                            <ons-button modifier="large--quiet" onclick="post('simple_toot_TL_input', {cw:document.getElementById('simple_toot_cw').value, visibility:document.getElementById('post_mode_simple').value, sensitive:document.getElementById('nsfw_input_simple').value, in_reply_to_id: document.getElementById('post_reply_simple').value}, true)" id="toot-button_simple"><ons-icon icon="fa-paper-plane-o"></ons-icon></ons-button>
                        </div>
                    </ons-list-item>
                </ons-list>
                <ons-list>
                    <ons-list-item style="padding-left: 0" class="simple-toot invisible" id="simple_more">
                        <ons-button modifier="quiet" onclick="post_mode(true)" class="no-rd" id="post_mode_bt_simple">公開</ons-button>
                        <ons-button modifier="quiet" onclick="showPopover(this, 'image_popover')" class="no-rd" id="new_up_bt_simple"><ons-icon icon="fa-picture-o"></ons-icon></ons-button>
                        <ons-button modifier="quiet" onclick="post_nsfw(true)" class="no-rd invisible" id="nsfw_bt_simple"><ons-icon icon="fa-eye"></ons-icon></ons-button>
                        <ons-button modifier="quiet" onclick="showPopover(this, 'cw_popover')" class="no-rd">CW</ons-button>
                        <ons-button modifier="quiet" onclick="showPopover(this, 'vote_popover')" class="no-rd"><ons-icon icon="fa-align-left"></ons-icon></ons-button>
                        <ons-button modifier="quiet" onclick="show_bbcodegen('simple_toot_TL_input')" class="no-rd"><ons-icon icon="fa-font"></ons-icon></ons-button>
                        <ons-button modifier="quiet" onclick="showPopover(this, 'emoji_popover')" class="no-rd"><ons-icon icon="fa-smile-o"></ons-icon></ons-button>
                        <ons-button modifier="quiet" class="no-rd" id="toot_limit_simple">4096</ons-button>
                        <ons-button modifier="quiet" class="no-rd" onclick="simple_close()"><ons-icon icon="fa-chevron-down"></ons-icon></ons-button>
                    </ons-list-item>
                </ons-list>
            </form>
        </ons-bottom-toolbar>

        <ons-popover direction="up" id="cw_popover">
            <div style="padding: 10px; text-align: center;">
                <p>
                    <ons-input id="simple_toot_cw" modifier="underbar" placeholder="警告文を書いてください" class="w-max black_text" onkeyup="check_limit(value, 'toot_limit_simple', 'toot-button_simple', 'simple_toot_TL_input');"></ons-input>
                </p>
                <p>
                    <ons-button onclick="hidePopover('cw_popover')" class="w-max">閉じる</ons-button>
                </p>
            </div>
        </ons-popover>

        <ons-popover direction="up" id="image_popover">
            <div style="padding: 10px; text-align: center;">
                <p>
                <div id="image_list_simple"></div>
                </p>
                <p>
                    <ons-button onclick="up_file(true)" class="w-max">画像追加</ons-button>
                </p>
                <p>
                    <ons-button onclick="hidePopover('image_popover')" class="w-max">閉じる</ons-button>
                </p>
            </div>
        </ons-popover>

        <ons-popover direction="up" id="vote_popover">
            <div style="padding: 10px; text-align: center;">
                <p>
                <form id="simple_vote">
                    <ons-input id="vote_new_1_simple" modifier="underbar" placeholder="項目1" class="w-max black_text"></ons-input>
                    <ons-input id="vote_new_2_simple" modifier="underbar" placeholder="項目2" class="w-max black_text"></ons-input>
                    <ons-input id="vote_new_3_simple" modifier="underbar" placeholder="項目3(任意)" class="w-max black_text"></ons-input>
                    <ons-input id="vote_new_4_simple" modifier="underbar" placeholder="項目4(任意)" class="w-max black_text"></ons-input>
                    <ons-select id="vote_new_time_simple" class="w-max black_text" modifier="underbar">
                        <option value="30">30秒</option>
                        <option value="60">1分</option>
                        <option value="180">3分</option>
                        <option value="300">5分</option>
                        <option value="600">10分</option>
                        <option value="3600">1時間</option>
                        <option value="86400">1日</option>
                    </ons-select>
                </form>
                </p>
                <p>
                    <ons-button onclick="hidePopover('vote_popover')" class="w-max">閉じる</ons-button>
                </p>
            </div>
        </ons-popover>
    </ons-page>
</ons-template>

<ons-template id="alert.html">
    <ons-page>
        <ons-toolbar>
            <div class="left" id="alert_button">
                <ons-toolbar-button onclick="fn.open()">
                    <ons-icon icon="fa-bars"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">通知</div>
            <div class="right">
                <ons-toolbar-button onclick="show('clear-alert')">
                    <ons-icon icon="trash"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>
        <ons-pull-hook id="ph-alert" class="dark-bg">
            <ons-icon icon="fa-refresh" class="white"></ons-icon>
        </ons-pull-hook>
        <div id="alert_main">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="config.html">
    <ons-page id="config-page">
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="fn.open()">
                    <ons-icon icon="fa-bars"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">設定</div>
        </ons-toolbar>
        <ons-list>
            <ons-list-item modifier="chevron" onclick="window.open('https://' + inst + '/about/more', '_blank')">
                <div class="left">
                    <i class="list-item__icon list-item--chevron__icon ons-icon fa-book fa fa-fw"></i>
                </div>
                <div class="center">
                    インスタンス情報
                </div>
            </ons-list-item>
            <ons-list-item modifier="chevron" tappable onclick="loadNav('about.html', null, true, true)">
                <div class="left">
                    <i class="list-item__icon list-item--chevron__icon ons-icon fa-book fa fa-fw"></i>
                </div>
                <div class="center">
                    このアプリについて
                </div>
            </ons-list-item>
            <ons-list-header>アカウント</ons-list-header>
            <ons-list-item onclick="show_account(localStorage.getItem('knzk_userid'))" id="account-conf-id">@ でログイン中</ons-list-item>
            <ons-list-item onclick="login_open()">トークンを再取得</ons-list-item>
            <ons-list-item onclick="show('logout_dialog')">ログアウト</ons-list-item>
        </ons-list>
        <ons-list>
            <ons-list-header>タイムライン設定</ons-list-header>
            <ons-list-item>
                <div class="center">
                    リアルタイム更新
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_realtime', 'conf-realtime')" input-id="conf-realtime"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    CW文章を常に表示する
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_cw', 'conf-cw')" input-id="conf-cw"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    NSFWメディアを常に表示する
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_nsfw', 'conf-nsfw')" input-id="conf-nsfw"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    TLをスライドして切り替え
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_swipe', 'conf-swipe')" input-id="conf-swipe"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    スピードダイヤル設定
                </div>
                <div class="right">
                    <ons-select id="conf-dial" onchange="change_conf('knzk_dial', 'conf-dial', true)">
                        <option value="">なし</option>
                        <option value="toot" id="dial_toot">トゥート</option>
                        <option value="alert" id="dial_alert">通知</option>
                        <option value="reload" id="dial_reload">TL更新</option>
                    </ons-select>
                </div>
            </ons-list-item>
        </ons-list>
        <ons-list>
            <ons-list-header>デザイン設定</ons-list-header>
            <ons-list-item>
                <div class="center">
                    大きなお気に入りボタン
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_bigfav', 'conf-fav-namu')" input-id="conf-fav-namu"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    アカウントリストの表示を小さくする
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_acct_list_small', 'conf-acct_list_small')" input-id="conf-acct_list_small"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    アニメーションを無効化
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_lite_mode', 'conf-lite-mode')" input-id="conf-lite-mode"></ons-switch>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    回転を無効化
                </div>
                <div class="right">
                    <ons-switch onclick="change_conf('knzk_spin', 'conf-spin')" input-id="conf-spin"></ons-switch>
                </div>
            </ons-list-item>
        </ons-list>
        <div class="container">
            <p class="note">設定は再起動後に反映されます。</p>
        </div>
    </ons-page>
</ons-template>

<ons-template id="post.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab('down')">
                    <ons-icon icon="fa-times"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">トゥート！</div>
            <div class="right">
                <ons-toolbar-button onclick="show_bbcodegen('toot_textarea', 'toot-limit', 'toot-button')">
                    <ons-icon icon="fa-font"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>
        <p></p>
        <div class="container">
            <div class="reply-box invisible" id="post_reply_box"><ons-icon icon="fa-reply"></ons-icon>　<span id="post_reply_acct"></span> へ返信</div>
            <div id="vote_new_list" style="display: none;">
                <p>
                    <ons-input id="vote_new_1" modifier="underbar" placeholder="項目1" class="w-max"></ons-input>
                    <ons-input id="vote_new_2" modifier="underbar" placeholder="項目2" class="w-max"></ons-input>
                    <ons-input id="vote_new_3" modifier="underbar" placeholder="項目3(任意)" class="w-max"></ons-input>
                    <ons-input id="vote_new_4" modifier="underbar" placeholder="項目4(任意)" class="w-max"></ons-input>
                    <ons-select id="vote_new_time" class="w-max" modifier="underbar">
                        <option value="30">30秒</option>
                        <option value="60">1分</option>
                        <option value="180">3分</option>
                        <option value="300">5分</option>
                        <option value="600">10分</option>
                        <option value="3600">1時間</option>
                        <option value="86400">1日</option>
                    </ons-select>
                </p>
            </div>
            <ons-input id="cw_input" modifier="underbar" placeholder="警告文を書いてください" class="w-max" style="display: none;" onkeyup="check_limit(value, 'toot-limit', 'toot-button', 'toot_textarea');"></ons-input>
            <textarea class="textarea dark-box-in" rows="5" placeholder="今なにしてる？" id="toot_textarea" style="width: 100%" onkeyup="check_limit(value, 'toot-limit', 'toot-button', 'cw_input');"></textarea>
            <div class="dark-box" style="border-radius: 0">
                <input type="hidden" id="nsfw_input">
                <input type="hidden" id="post_mode" value="public">
                <input type="hidden" id="post_reply">
                <ons-button modifier="quiet" onclick="up_file()" style="border-radius: 0" id="new_up_bt"><ons-icon icon="fa-picture-o"></ons-icon></ons-button>
                <ons-button modifier="quiet" onclick="post_nsfw()" style="border-radius: 0" class="invisible" id="nsfw_bt"><ons-icon icon="fa-eye"></ons-icon></ons-button>
                <ons-button modifier="quiet" onclick="post_cw()" style="border-radius: 0" id="cw_bt">CW</ons-button>
                <ons-button modifier="quiet" onclick="post_vote()" style="border-radius: 0" id="vote_bt"><ons-icon icon="fa-align-left"></ons-icon></ons-button>
            </div>
            <div class="dark-box">
                <ons-button modifier="quiet" onclick="post_mode()" style="border-radius: 0 0 0 4px" id="post_mode_bt">公開</ons-button>
                <ons-button modifier="quiet" onclick="showPopover(this, 'emoji_popover')"><ons-icon icon="fa-smile-o"></ons-icon></ons-button>
                <span style="float: right">
                <b id="toot-limit" class="toot-limit">4096</b>
                <ons-button onclick="post('toot_textarea', {cw:document.getElementById('cw_input').value, visibility:document.getElementById('post_mode').value, sensitive:document.getElementById('nsfw_input').value, in_reply_to_id: document.getElementById('post_reply').value})" id="toot-button" style="border-radius: 4px 0 4px 0">トゥート！</ons-button>
                </span>
            </div>
            <div id="image_list"></div>
        </div>

    </ons-page>
</ons-template>

<ons-template id="bbcode.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center">BBCode</div>
            <div class="right">
                <ons-toolbar-button onclick="bbcodegen()">
                    <ons-icon icon="fa-plus"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>
        <p></p>
        <input type="hidden" id="bbcode_color">
        <div class="container">
            <p>
                <ons-input id="bbcode_text" modifier="underbar" placeholder="文字列" class="w-max"></ons-input>
            </p>
        </div>
        <ons-list>
            <ons-list-item>
                <div class="center">
                    基本
                </div>
                <div class="right">
                    <ons-select id="bbcode_base" modifier="underbar">
                        <option value="">なし</option>
                        <option value="b"><b>太字</b></option>
                        <option value="i"><i>斜体</i></option>
                        <option value="u"><u>アンダーライン</u></option>
                        <option value="s"><s>取り消し</s></option>
                    </ons-select>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    色指定
                </div>
                <div class="right">
                    <div class="color-box-mini" id="color-box-mini"></div>　
                    <ons-button onclick="loadNav('color.html')">変更</ons-button>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    大きさ
                </div>
                <div class="right">
                    <ons-select id="bbcode_large" modifier="underbar">
                        <option value="">1x</option>
                        <option value="2">2x</option>
                        <option value="3">3x</option>
                        <option value="4">4x</option>
                        <option value="5">5x</option>
                    </ons-select>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    回転
                </div>
                <div class="right">
                    <ons-input id="bbcode_spin" modifier="underbar" type="number" value=0></ons-input>
                </div>
            </ons-list-item>
            <ons-list-item>
                <div class="center">
                    点滅
                </div>
                <div class="right">
                    <ons-input id="bbcode_pulse" modifier="underbar" type="number" value=0></ons-input>
                </div>
            </ons-list-item>
        </ons-list>
    </ons-page>
</ons-template>

<ons-template id="color.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center">カラー選択</div>
        </ons-toolbar>
        <p></p>
        <div class="container">
            <div class="row">
                <div class="col-xs-4 color-box-base" onclick="bbcode_color()">
                    <div class="color-box"></div>
                    標準
                </div>
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('FF0000')">
                    <div class="color-box" style="background-color: #FF0000;"></div>
                    赤
                </div>
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('0000FF')">
                    <div class="color-box" style="background-color: #0000FF;"></div>
                    青
                </div>
            </div>
            <div class="row">
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('FFFF00')">
                    <div class="color-box" style="background-color: #FFFF00;"></div>
                    黄
                </div>
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('008000')">
                    <div class="color-box" style="background-color: #008000;"></div>
                    緑
                </div>
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('000000')">
                    <div class="color-box" style="background-color: #000000;"></div>
                    黒
                </div>
            </div>
            <div class="row">
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('FFFFFF')">
                    <div class="color-box" style="background-color: #FFFFFF;"></div>
                    白
                </div>
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('87CEEB')">
                    <div class="color-box" style="background-color: #87CEEB;"></div>
                    こおりたそ
                </div>
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('FF5B92')">
                    <div class="color-box" style="background-color: #FF5B92;"></div>
                    みつきちゃん
                </div>
            </div>
            <div class="row">
                <div class="col-xs-4 color-box-base" onclick="bbcode_color('A55A4A')">
                    <div class="color-box" style="background-color: #A55A4A;"></div>
                    しげる
                </div>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="showtoot.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
        </ons-toolbar>

        <div id="show_toot">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="showtag.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center" id="showtag_title">
                読み込み中...
            </div>
            <div class="right">
                <ons-toolbar-button onclick="post_pre('#'+ decodeURI(tag_str))">
                    <ons-icon icon="fa-pencil"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>

        <div id="tag_main">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="showfollow.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center" id="follow-page-title">読み込み中...</div>
        </ons-toolbar>

        <div id="show_follow">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="olist.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="fn.open()">
                    <ons-icon icon="fa-bars"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center" id="olist_title">読み込み中...</div>
        </ons-toolbar>

        <div id="olist_main">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="olist_nav.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center" id="olist_nav_title">読み込み中...</div>
        </ons-toolbar>

        <div id="olist_nav_main">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="account.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center" id="userpage-title">読み込み中...</div>
        </ons-toolbar>
        <input type="hidden" id="acct_block">
        <input type="hidden" id="acct_mute">
        <div class="userpage-button-bg">
            <ons-icon icon="fa-user-plus" class="userpage-button" id="userpage-follow-button" onclick="account_state_action(account_page_id, this, 'follow')"></ons-icon>
            <div class="userpage-follower invisible" id="userpage-followreq-badge">承認待ち</div>
            <div class="userpage-follower invisible" id="userpage-follower-badge">フォロワー</div>
            <div class="userpage-follower invisible" id="userpage-mute-badge">ミュート中</div>
            <div class="userpage-follower invisible" id="userpage-block-badge">ブロック中</div>
        </div>
        <div class="userpage-button-bg userpage-button-right">
            <ons-icon icon="fa-bars" class="userpage-button" onclick="account_action(account_page_id)" id="acct_action_bt"></ons-icon>
        </div>
        <div class="user-bg y-center" id="userpage-bg">
            <img src="img/missing.png" id="userpage-icon" class="user-logo-profile" />
            <div class="card-bio">
                <h3 id="userpage-name" class="user-name"></h3>
                <div class="user-acct"><span id="userpage-acct"></span> <ons-icon icon="fa-lock" id="userpage-lock" class="invisible"></ons-icon></div>
                <div class="user-bio" id="userpage-bio"></div>
                <div class="user-follow">
                    <span onclick="showFollow(account_page_id, 'follow')"><b id="userpage-follow"></b> フォロー</span> / <span onclick="showFollow(account_page_id, 'follower')"><b id="userpage-follower"></b> フォロワー</span>
                </div>
            </div>
        </div>

        <div class="account_bar">
            <div class="account_links">
                <span class="account_tab" onclick="showAccountTL(account_page_id)">トゥート (<b id="userpage-post-count"></b>)</span>
                <span class="account_tab" onclick="showAccountTL(account_page_id, null, true)">メディア</span>
            </div>
        </div>
        <div id="account_pinned_toot"></div>
        <div id="account_toot">
            <div class="loading-now">
                <ons-progress-circular indeterminate></ons-progress-circular>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="about.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="BackTab()">
                    <ons-icon icon="fa-chevron-left"></ons-icon>
                    戻る
                </ons-toolbar-button>
            </div>
            <div class="center">このアプリについて</div>
        </ons-toolbar>
        <p></p>
        <div class="container">
            <div class="w-max main-logo y-center">
                <img src="img/logo.svg" style="width: 80%;"/>
            </div>
            <p>
                <b>神崎丼アプリ 1.0.0b3</b>
            </p>
            <span class="fa fa-spin"><b>南無！ｗ</b></span>
            <p></p>
            <p>
                KnzkAppはオープンソースソフトウェアです。<br><a href="https://github.com/KnzkDev/KnzkApp" target="_blank"><i class="fa fa-github"></i> KnzkDev/KnzkApp</a> から開発に参加したり、問題を報告する事ができます。
            </p>
        </div>
        <ons-list>
            <ons-list-header>クレジット</ons-list-header>
            <ons-list-item onclick="window.open('https://knzk.me/@y', '_blank')">アプリ開発: ねじりわさび</ons-list-item>
            <ons-list-item onclick="window.open('https://knzk.me/@twotwo', '_blank')">ロゴ画像: ネイティオ</ons-list-item>
            <ons-list-item onclick="window.open('https://knzk.me/@annotunzdy', '_blank')">iOS版配布: あんのたん</ons-list-item>
            <ons-list-item onclick="window.open('https://knzk.me/@knzk', '_blank')">神崎丼運営: 神崎おにいさん</ons-list-item>
            <ons-list-item onclick="window.open('https://knzk.me/@imncls', '_blank')">神崎丼運営 / ロゴ画像: NCLS</ons-list-item>
            <ons-list-item onclick="window.open('https://knzk.me/@_5', '_blank')">神崎丼運営: 🍊</ons-list-item>
        </ons-list>
    </ons-page>
</ons-template>

<ons-template id="login.html">
    <ons-page>
        <ons-page>
            <ons-toolbar>
                <div class="center">
                    ログイン
                </div>
                <div class="right">
                    <ons-toolbar-button onclick="loadNav('about.html')">
                        <ons-icon icon="fa-info-circle"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <div class="container">
                <div class="y-center">
                    <p></p>
                    <div class="w-max main-logo">
                        <img src="img/logo.svg" style="width: 80%;"/>
                    </div>
                    <p><ons-button modifier="large" onclick="login_open()"><b>knzk.meにログイン</b></ons-button></p>
                    <p><a href="https://knzk.me/about/more">利用規約</a> | <a href="https://knzk.me/terms">プライバシーポリシー</a></p>
                </div>
            </div>
        </ons-page>
    </ons-page>
</ons-template>

<ons-popover direction="up" id="emoji_popover">
    <div style="padding: 5px; text-align: center;">
        <p id="emoji_list_popover" class="emoji_list_scroll">load</p>
        <p>
            <ons-button onclick="hidePopover('emoji_popover')" class="w-max">閉じる</ons-button>
        </p>
    </div>
</ons-popover>

<div id="alert_list">
    <ons-modal direction="up" id="now_loading">
        <div style="text-align: center">
            <p>
                <ons-progress-circular indeterminate></ons-progress-circular>
            </p>
        </div>
    </ons-modal>

    <ons-toast id="loggedin_dialog">
        ログインしました！<button onclick="hide('loggedin_dialog')">閉じる</button>
    </ons-toast>

    <ons-alert-dialog id="delete-post">
        <div class="alert-dialog-title">トゥートを削除</div>
        <div class="alert-dialog-content">
            本当に削除しますか？
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="hide('delete-post')">キャンセル</button>
            <button class="alert-dialog-button" onclick="delete_post()">削除</button>
        </div>
    </ons-alert-dialog>
    <ons-toast id="del-post-ok">
        トゥートを削除しました。
    </ons-toast>

    <ons-alert-dialog id="logout_dialog">
        <div class="alert-dialog-title">ログアウト</div>
        <div class="alert-dialog-content">
            ログアウトしてもよろしいですか？
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="hide('logout_dialog')">戻る</button>
            <button class="alert-dialog-button" onclick="logout()">ログアウト</button>
        </div>
    </ons-alert-dialog>
    <ons-toast id="loggedout_dialog">
        ログアウトしました<button onclick="hide('loggedout_dialog')">閉じる</button>
    </ons-toast>

    <ons-toast id="report-post">
        レポートのご協力ありがとうございます。
    </ons-toast>
    <ons-toast id="ok-clear-alert">
        通知を消去しました。
    </ons-toast>
    <ons-toast id="ok_conf">
        設定を保存しました。
    </ons-toast>
    <ons-toast id="ok_conf_2">
        設定しました。
    </ons-toast>

    <ons-toast id="post_now">
        投稿しています... <span class="fa fa-spin"><span class="fa fa-spin"><ons-icon icon="fa-refresh" class="white"></ons-icon></span></ons-icon></span>
    </ons-toast>

    <ons-toast id="vote-ok">
        投票に成功しました！
    </ons-toast>
    <ons-toast id="vote-ng">
        投票に失敗しました。<br>
        投票済みか締め切りとなっている可能性があります。
    </ons-toast>
    <!-- エラー -->
    <ons-toast id="maximum-media">
        エラー: これ以上画像をアップする事はできません。
    </ons-toast>
    <ons-toast id="bbcode-limit">
        エラー: 文字数制限を超えています！<br>
        回転や点滅、文字列を少なくしてください。
    </ons-toast>
    <ons-toast id="cannot-pros">
        エラー: 実行できませんでした。<br>
        接続環境が悪いか鯖落ちしている可能性があります。
    </ons-toast>
    <ons-toast id="cannot-post">
        エラー: 投稿できませんでした。<br>
        接続環境が悪いか鯖落ちしている可能性があります。
    </ons-toast>
    <ons-toast id="cannot-load">
        エラー: 取得できませんでした。<br>
        接続環境が悪いか鯖落ちしている可能性があります。
    </ons-toast>
    <ons-alert-dialog id="cannot-get-code">
        <div class="alert-dialog-title">エラー</div>
        <div class="alert-dialog-content">
            コードが取得できませんでした！<br>
            認証画面で拒否していませんか？
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="hide('cannot-get-code')">閉じる</button>
        </div>
    </ons-alert-dialog>

    <ons-alert-dialog id="clear-alert">
        <div class="alert-dialog-title">通知を消去</div>
        <div class="alert-dialog-content">
            本当に通知を消去してもよろしいですか？
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="hide('clear-alert')">キャンセル</button>
            <button class="alert-dialog-button" onclick="reset_alert()">通知を消去</button>
        </div>
    </ons-alert-dialog>

    <ons-alert-dialog id="cannot-use-ls">
        <div class="alert-dialog-title">エラー</div>
        <div class="alert-dialog-content">
            LocalStorageが使用できません。
        </div>
    </ons-alert-dialog>

    <ons-alert-dialog id="cannot-connect-sv">
        <div class="alert-dialog-title">エラー</div>
        <div class="alert-dialog-content">
            インスタンスに接続できません！<br>
            サーバーが落ちているか、通信環境が悪い可能性があります。
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="init()">再試行</button>
        </div>
    </ons-alert-dialog>

    <ons-alert-dialog id="cannot-connect-mastodon">
        <div class="alert-dialog-title">エラー</div>
        <div class="alert-dialog-content">
            インスタンスに接続できません！<br>
            サーバーが落ちている可能性があります。<br>
            詳細はシステム状態のページをご覧ください。
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="window.open('http://'+stat_sv, '_blank')">ステータスページへ</button>
            <button class="alert-dialog-button" onclick="init()">再試行</button>
        </div>
    </ons-alert-dialog>

    <ons-alert-dialog id="cannot-connect-internet">
        <div class="alert-dialog-title">エラー</div>
        <div class="alert-dialog-content">
            インターネットに接続できません！<br>
            通信環境が悪い可能性があります。
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="init()">再試行</button>
        </div>
    </ons-alert-dialog>

    <ons-alert-dialog id="cannot-connect-API">
        <div class="alert-dialog-title">エラー</div>
        <div class="alert-dialog-content">
            APIを認証できませんでした。<br>
            「認証済みアプリ」からKnzkAppを削除していませんか？
        </div>
        <div class="alert-dialog-footer">
            <button class="alert-dialog-button" onclick="login_open()">ログインする</button>
            <button class="alert-dialog-button" onclick="init()">再試行</button>
        </div>
    </ons-alert-dialog>
</div>
</body>
</html>
